{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/pietromontanti/Desktop/approved-clean/Approved/lib/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\n// Export a variable and assign it below to avoid `export` inside conditionals\nexport let supabaseAdmin: any = null;\n\n// If real env vars are present, use real client. Otherwise, if testing is enabled,\n// provide a lightweight in-memory fake client to allow local tests without secrets.\nif (supabaseUrl && supabaseServiceKey) {\n  // Admin client â€” use only on the server\n  supabaseAdmin = createClient(supabaseUrl, supabaseServiceKey, {\n    auth: { persistSession: false },\n  });\n} else if (process.env.APP_ALLOW_FAKE_SUPABASE === '1') {\n  // Simple in-memory fake DB with minimal API surface used by the server routes.\n  type Row = Record<string, any>;\n  const db: Record<string, Row[]> = {\n    projects: [\n      { id: 'p1', team_id: 't1', owner_id: 'owner-1', name: 'Test Project' },\n    ],\n    share_links: [],\n    project_members: [],\n    team_members: [ { team_id: 't1', user_id: 'owner-1', role: 'owner' } ],\n    audit_logs: [],\n  };\n\n  const { v4: uuidv4 } = require('uuid');\n  function clone(obj: any) { return JSON.parse(JSON.stringify(obj)); }\n\n  function createFrom(tableName: string) {\n    let q: any = {\n      _table: tableName,\n      _select: '*',\n      _where: [] as Array<{k:string,v:any}>,\n      _limit: null as number | null,\n      select(cols?: string) { q._select = cols || '*'; return q; },\n      eq(k: string, v: any) { q._where.push({k,v}); return q; },\n      limit(n: number) { q._limit = n; return q; },\n      maybeSingle: async () => {\n        const rows = db[tableName] || [];\n        const filtered = rows.filter(r => q._where.every(w => String(r[w.k]) === String(w.v)));\n        return { data: filtered.length>0 ? clone(filtered[0]) : null, error: null };\n      },\n      insert: (payload: any) => {\n        const rows = db[tableName] || (db[tableName] = []);\n        const toInsert = Array.isArray(payload) ? payload : [payload];\n        const inserted = toInsert.map((p: any) => {\n          const row = Object.assign({}, p);\n          if (!row.id) row.id = uuidv4();\n          row.created_at = new Date().toISOString();\n          rows.push(row);\n          return row;\n        });\n        return {\n          data: inserted,\n          error: null,\n          select: () => ({\n            single: async () => ({ data: inserted[0], error: null })\n          })\n        };\n      },\n      update: (payload: any) => {\n        // return chainable object supporting .eq(k,v)\n        return {\n          eq: async (k: string, v: any) => {\n            const rows = db[tableName] || [];\n            let updatedCount = 0;\n            for (let r of rows) {\n              if (q._where.every(w => String(r[w.k]) === String(w.v)) && String(r[k]) === String(v)) {\n                Object.assign(r, payload);\n                updatedCount++;\n              }\n            }\n            return { data: updatedCount>0 ? rows.filter(r => (q._where.every(w => String(r[w.k]) === String(w.v)) && String(r[k]) === String(v))) : [], error: null };\n          }\n        };\n      },\n      upsert: async (payload: any, opts?: any) => {\n        const rows = db[tableName] || (db[tableName] = []);\n        // naive onConflict by project_id,member_id\n        const existing = rows.find(r => r.project_id === payload.project_id && r.member_id === payload.member_id);\n        if (existing) {\n          Object.assign(existing, payload);\n          return { data: [existing], error: null };\n        }\n        const row = Object.assign({}, payload);\n        if (!row.id) row.id = uuidv4();\n        rows.push(row);\n        return { data: [row], error: null };\n      },\n      single: async () => {\n        const rows = db[tableName] || [];\n        const filtered = rows.filter(r => q._where.every(w => String(r[w.k]) === String(w.v)));\n        return { data: filtered[0] || null, error: null };\n      }\n    };\n    return q;\n  }\n\n  const fakeAdmin = {\n    from: (table: string) => createFrom(table),\n  };\n\n  supabaseAdmin = fakeAdmin as any;\n} else {\n  throw new Error(\n    \"Missing NEXT_PUBLIC_SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY in environment. Set APP_ALLOW_FAKE_SUPABASE=1 to enable a local fake client for tests.\"\n  );\n}\n\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;AAGzD,IAAI,gBAAqB;AAEhC,mFAAmF;AACnF,oFAAoF;AACpF,IAAI,eAAe,oBAAoB;IACrC,wCAAwC;IACxC,gBAAgB,IAAA,yLAAY,EAAC,aAAa,oBAAoB;QAC5D,MAAM;YAAE,gBAAgB;QAAM;IAChC;AACF,OAAO,IAAI,QAAQ,GAAG,CAAC,uBAAuB,KAAK,KAAK;IAGtD,MAAM,KAA4B;QAChC,UAAU;YACR;gBAAE,IAAI;gBAAM,SAAS;gBAAM,UAAU;gBAAW,MAAM;YAAe;SACtE;QACD,aAAa,EAAE;QACf,iBAAiB,EAAE;QACnB,cAAc;YAAE;gBAAE,SAAS;gBAAM,SAAS;gBAAW,MAAM;YAAQ;SAAG;QACtE,YAAY,EAAE;IAChB;IAEA,MAAM,EAAE,IAAI,MAAM,EAAE;IACpB,SAAS,MAAM,GAAQ;QAAI,OAAO,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;IAAO;IAEnE,SAAS,WAAW,SAAiB;QACnC,IAAI,IAAS;YACX,QAAQ;YACR,SAAS;YACT,QAAQ,EAAE;YACV,QAAQ;YACR,QAAO,IAAa;gBAAI,EAAE,OAAO,GAAG,QAAQ;gBAAK,OAAO;YAAG;YAC3D,IAAG,CAAS,EAAE,CAAM;gBAAI,EAAE,MAAM,CAAC,IAAI,CAAC;oBAAC;oBAAE;gBAAC;gBAAI,OAAO;YAAG;YACxD,OAAM,CAAS;gBAAI,EAAE,MAAM,GAAG;gBAAG,OAAO;YAAG;YAC3C,aAAa;gBACX,MAAM,OAAO,EAAE,CAAC,UAAU,IAAI,EAAE;gBAChC,MAAM,WAAW,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,CAAC,KAAK,CAAC,CAAA,IAAK,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,OAAO,EAAE,CAAC;gBACnF,OAAO;oBAAE,MAAM,SAAS,MAAM,GAAC,IAAI,MAAM,QAAQ,CAAC,EAAE,IAAI;oBAAM,OAAO;gBAAK;YAC5E;YACA,QAAQ,CAAC;gBACP,MAAM,OAAO,EAAE,CAAC,UAAU,IAAI,CAAC,EAAE,CAAC,UAAU,GAAG,EAAE;gBACjD,MAAM,WAAW,MAAM,OAAO,CAAC,WAAW,UAAU;oBAAC;iBAAQ;gBAC7D,MAAM,WAAW,SAAS,GAAG,CAAC,CAAC;oBAC7B,MAAM,MAAM,OAAO,MAAM,CAAC,CAAC,GAAG;oBAC9B,IAAI,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,GAAG;oBACtB,IAAI,UAAU,GAAG,IAAI,OAAO,WAAW;oBACvC,KAAK,IAAI,CAAC;oBACV,OAAO;gBACT;gBACA,OAAO;oBACL,MAAM;oBACN,OAAO;oBACP,QAAQ,IAAM,CAAC;4BACb,QAAQ,UAAY,CAAC;oCAAE,MAAM,QAAQ,CAAC,EAAE;oCAAE,OAAO;gCAAK,CAAC;wBACzD,CAAC;gBACH;YACF;YACA,QAAQ,CAAC;gBACP,8CAA8C;gBAC9C,OAAO;oBACL,IAAI,OAAO,GAAW;wBACpB,MAAM,OAAO,EAAE,CAAC,UAAU,IAAI,EAAE;wBAChC,IAAI,eAAe;wBACnB,KAAK,IAAI,KAAK,KAAM;4BAClB,IAAI,EAAE,MAAM,CAAC,KAAK,CAAC,CAAA,IAAK,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,OAAO,EAAE,CAAC,MAAM,OAAO,CAAC,CAAC,EAAE,MAAM,OAAO,IAAI;gCACrF,OAAO,MAAM,CAAC,GAAG;gCACjB;4BACF;wBACF;wBACA,OAAO;4BAAE,MAAM,eAAa,IAAI,KAAK,MAAM,CAAC,CAAA,IAAM,EAAE,MAAM,CAAC,KAAK,CAAC,CAAA,IAAK,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,OAAO,EAAE,CAAC,MAAM,OAAO,CAAC,CAAC,EAAE,MAAM,OAAO,MAAO,EAAE;4BAAE,OAAO;wBAAK;oBAC1J;gBACF;YACF;YACA,QAAQ,OAAO,SAAc;gBAC3B,MAAM,OAAO,EAAE,CAAC,UAAU,IAAI,CAAC,EAAE,CAAC,UAAU,GAAG,EAAE;gBACjD,2CAA2C;gBAC3C,MAAM,WAAW,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,UAAU,KAAK,QAAQ,UAAU,IAAI,EAAE,SAAS,KAAK,QAAQ,SAAS;gBACxG,IAAI,UAAU;oBACZ,OAAO,MAAM,CAAC,UAAU;oBACxB,OAAO;wBAAE,MAAM;4BAAC;yBAAS;wBAAE,OAAO;oBAAK;gBACzC;gBACA,MAAM,MAAM,OAAO,MAAM,CAAC,CAAC,GAAG;gBAC9B,IAAI,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,GAAG;gBACtB,KAAK,IAAI,CAAC;gBACV,OAAO;oBAAE,MAAM;wBAAC;qBAAI;oBAAE,OAAO;gBAAK;YACpC;YACA,QAAQ;gBACN,MAAM,OAAO,EAAE,CAAC,UAAU,IAAI,EAAE;gBAChC,MAAM,WAAW,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,CAAC,KAAK,CAAC,CAAA,IAAK,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,OAAO,EAAE,CAAC;gBACnF,OAAO;oBAAE,MAAM,QAAQ,CAAC,EAAE,IAAI;oBAAM,OAAO;gBAAK;YAClD;QACF;QACA,OAAO;IACT;IAEA,MAAM,YAAY;QAChB,MAAM,CAAC,QAAkB,WAAW;IACtC;IAEA,gBAAgB;AAClB,OAAO;IACL,MAAM,IAAI,MACR;AAEJ"}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///Users/pietromontanti/Desktop/approved-clean/Approved/app/api/invites/route.ts"],"sourcesContent":["// app/api/invites/route.ts\nimport { NextResponse } from \"next/server\";\nimport { createClient } from \"@supabase/supabase-js\";\nimport { supabaseAdmin } from \"@/lib/supabaseAdmin\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\nconst supabase = createClient(supabaseUrl, supabaseKey);\n\n/**\n * GET /api/invites?team_id=xxx\n * Lista inviti di un team (solo owner)\n */\nexport async function GET(req: Request) {\n  try {\n    // Determine actor: prefer Authorization Bearer token, then x-actor-id header, then cookie-based anon client\n    const authHeader = req.headers.get('authorization') || '';\n    let actorId: string | null = null;\n\n    if (authHeader.toLowerCase().startsWith('bearer ')) {\n      const token = authHeader.split(' ')[1];\n      try {\n        const { data: verified, error: verifyErr } = await supabaseAdmin.auth.getUser(token);\n        if (!verifyErr && verified?.user?.id) actorId = verified.user.id;\n        else console.warn('[/api/invites] supabaseAdmin.auth.getUser failed', verifyErr);\n      } catch (e) {\n        console.warn('[/api/invites] token verification error', e);\n      }\n    }\n\n    if (!actorId) {\n      const hdr = req.headers.get('x-actor-id');\n      if (hdr) actorId = hdr;\n    }\n\n    if (!actorId) {\n      const supabase = createClient(supabaseUrl, supabaseKey);\n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      if (user?.id) actorId = user.id;\n      if (authError || !actorId) return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const url = new URL(req.url);\n    const teamId = url.searchParams.get(\"team_id\");\n\n    if (!teamId) {\n      return NextResponse.json({ error: \"team_id required\" }, { status: 400 });\n    }\n\n    // Use admin client to check membership (bypass RLS)\n    const { data: membership } = await supabaseAdmin\n      .from(\"team_members\")\n      .select(\"role\")\n      .eq(\"user_id\", actorId)\n      .eq(\"team_id\", teamId)\n      .single();\n\n    if (!membership || membership.role !== \"owner\") {\n      return NextResponse.json({ error: \"Forbidden\" }, { status: 403 });\n    }\n\n    // Recupera inviti attivi\n    const { data: invites, error } = await supabase\n      .from(\"invites\")\n      .select(\"*\")\n      .eq(\"team_id\", teamId)\n      .eq(\"revoked\", false)\n      .is(\"used_at\", null)\n      .gte(\"expires_at\", new Date().toISOString())\n      .order(\"created_at\", { ascending: false });\n\n    if (error) throw error;\n\n    return NextResponse.json({ invites });\n  } catch (error: any) {\n    console.error(\"Error fetching invites:\", error);\n    return NextResponse.json({ error: error.message }, { status: 500 });\n  }\n}\n\n/**\n * POST /api/invites\n * Crea un nuovo invito\n * Body: { team_id, project_id?, email?, role, is_link_invite }\n */\nexport async function POST(req: Request) {\n  try {\n    // Determine actorId: prefer Authorization Bearer token, then x-actor-id header, then cookie-based anon client\n    const authHeaderPost = req.headers.get('authorization') || '';\n    let actorId: string | null = null;\n    if (authHeaderPost.toLowerCase().startsWith('bearer ')) {\n      const token = authHeaderPost.split(' ')[1];\n      try {\n        const { data: verified, error: verifyErr } = await supabaseAdmin.auth.getUser(token);\n        if (!verifyErr && verified?.user?.id) actorId = verified.user.id;\n        else console.warn('[/api/invites POST] supabaseAdmin.auth.getUser failed', verifyErr);\n      } catch (e) {\n        console.warn('[/api/invites POST] token verification error', e);\n      }\n    }\n\n    if (!actorId) {\n      const hdr = req.headers.get('x-actor-id');\n      if (hdr) actorId = hdr;\n    }\n\n    if (!actorId) {\n      const supabase = createClient(supabaseUrl, supabaseKey);\n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      if (user?.id) actorId = user.id;\n      if (authError || !actorId) return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const body = await req.json();\n    const { team_id, project_id, email, role, is_link_invite } = body;\n\n    if (!team_id || !role) {\n      return NextResponse.json(\n        { error: \"team_id and role are required\" },\n        { status: 400 }\n      );\n    }\n\n    if (!is_link_invite && !email) {\n      return NextResponse.json(\n        { error: \"email is required for non-link invites\" },\n        { status: 400 }\n      );\n    }\n\n    // Call RPC using admin client to ensure permissions\n    const { data, error } = await supabaseAdmin.rpc(\"create_invite\", {\n      p_team_id: team_id,\n      p_project_id: project_id || null,\n      p_email: email || null,\n      p_role: role,\n      p_is_link_invite: is_link_invite || false,\n      p_invited_by: actorId,\n      p_expires_in_days: 7,\n    });\n\n    if (error) throw error;\n\n    if (!data.success) {\n      return NextResponse.json({ error: data.error }, { status: 400 });\n    }\n\n    // Build a safe origin: prefer NEXT_PUBLIC_APP_URL, then Origin header, then x-forwarded-proto + host, then host with http fallback\n    const envUrl = process.env.NEXT_PUBLIC_APP_URL;\n    const originHeader = req.headers.get(\"origin\");\n    const forwardedProto = req.headers.get(\"x-forwarded-proto\");\n    const hostHeader = req.headers.get(\"host\");\n    const fallbackProto = forwardedProto || \"http\";\n    const computedOrigin = envUrl || originHeader || (hostHeader ? `${fallbackProto}://${hostHeader}` : `http://localhost:3000`);\n    const safeOrigin = computedOrigin.replace(/\\/+$/, \"\");\n\n    return NextResponse.json({\n      success: true,\n      invite_id: data.invite_id,\n      invite_url: `${safeOrigin}/invite/${data.invite_id}`,\n    });\n  } catch (error: any) {\n    console.error(\"Error creating invite:\", error);\n    return NextResponse.json({ error: error.message }, { status: 500 });\n  }\n}\n\n/**\n * DELETE /api/invites?invite_id=xxx\n * Revoca un invito\n */\nexport async function DELETE(req: Request) {\n  try {\n    const authHeaderDel = req.headers.get('authorization') || '';\n    let actorIdDel: string | null = null;\n    if (authHeaderDel.toLowerCase().startsWith('bearer ')) {\n      const token = authHeaderDel.split(' ')[1];\n      try {\n        const { data: verified, error: verifyErr } = await supabaseAdmin.auth.getUser(token);\n        if (!verifyErr && verified?.user?.id) actorIdDel = verified.user.id;\n      } catch (e) {\n        console.warn('[/api/invites DELETE] token verification error', e);\n      }\n    }\n    if (!actorIdDel) actorIdDel = req.headers.get('x-actor-id');\n    if (!actorIdDel) {\n      const supabase = createClient(supabaseUrl, supabaseKey);\n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      if (user?.id) actorIdDel = user.id;\n      if (authError || !actorIdDel) return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const url = new URL(req.url);\n    const inviteId = url.searchParams.get(\"invite_id\");\n\n    if (!inviteId) {\n      return NextResponse.json({ error: \"invite_id required\" }, { status: 400 });\n    }\n\n    // Usa la funzione RPC per revocare l'invito\n    const { data, error } = await supabaseAdmin.rpc(\"revoke_invite\", {\n      invite_token: inviteId,\n      revoking_user_id: actorIdDel,\n    });\n\n    if (error) throw error;\n\n    if (!data.success) {\n      return NextResponse.json({ error: data.error }, { status: 400 });\n    }\n\n    return NextResponse.json({ success: true });\n  } catch (error: any) {\n    console.error(\"Error revoking invite:\", error);\n    return NextResponse.json({ error: error.message }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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"}}]
}