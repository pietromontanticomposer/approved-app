{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/pietromontanti/Desktop/approved-clean/Approved/lib/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\n// Export a variable and assign it below to avoid `export` inside conditionals\nexport let supabaseAdmin: any = null;\n\n// If real env vars are present, use real client. Otherwise, if testing is enabled,\n// provide a lightweight in-memory fake client to allow local tests without secrets.\nif (supabaseUrl && supabaseServiceKey) {\n  // Admin client â€” use only on the server\n  supabaseAdmin = createClient(supabaseUrl, supabaseServiceKey, {\n    auth: { persistSession: false },\n  });\n} else if (process.env.APP_ALLOW_FAKE_SUPABASE === '1') {\n  // Simple in-memory fake DB with minimal API surface used by the server routes.\n  type Row = Record<string, any>;\n  const db: Record<string, Row[]> = {\n    projects: [\n      { id: 'p1', team_id: 't1', owner_id: 'owner-1', name: 'Test Project' },\n    ],\n    share_links: [],\n    project_members: [],\n    team_members: [ { team_id: 't1', user_id: 'owner-1', role: 'owner' } ],\n    audit_logs: [],\n  };\n\n  const { v4: uuidv4 } = require('uuid');\n  function clone(obj: any) { return JSON.parse(JSON.stringify(obj)); }\n\n  function createFrom(tableName: string) {\n    const q: any = {\n      _table: tableName,\n      _select: '*',\n      _where: [] as Array<{k:string,v:any}>,\n      _limit: null as number | null,\n      select(cols?: string) { q._select = cols || '*'; return q; },\n      eq(k: string, v: any) { q._where.push({k,v}); return q; },\n      limit(n: number) { q._limit = n; return q; },\n      maybeSingle: async () => {\n        const rows = db[tableName] || [];\n        const filtered = rows.filter(r => q._where.every(w => String(r[w.k]) === String(w.v)));\n        return { data: filtered.length>0 ? clone(filtered[0]) : null, error: null };\n      },\n      insert: (payload: any) => {\n        const rows = db[tableName] || (db[tableName] = []);\n        const toInsert = Array.isArray(payload) ? payload : [payload];\n        const inserted = toInsert.map((p: any) => {\n          const row = Object.assign({}, p);\n          if (!row.id) row.id = uuidv4();\n          row.created_at = new Date().toISOString();\n          rows.push(row);\n          return row;\n        });\n        return {\n          data: inserted,\n          error: null,\n          select: () => ({\n            single: async () => ({ data: inserted[0], error: null })\n          })\n        };\n      },\n      update: (payload: any) => {\n        // return chainable object supporting .eq(k,v)\n        return {\n          eq: async (k: string, v: any) => {\n            const rows = db[tableName] || [];\n            let updatedCount = 0;\n            for (const r of rows) {\n              if (q._where.every(w => String(r[w.k]) === String(w.v)) && String(r[k]) === String(v)) {\n                Object.assign(r, payload);\n                updatedCount++;\n              }\n            }\n            return { data: updatedCount>0 ? rows.filter(r => (q._where.every(w => String(r[w.k]) === String(w.v)) && String(r[k]) === String(v))) : [], error: null };\n          }\n        };\n      },\n      upsert: async (payload: any, opts?: any) => {\n        const rows = db[tableName] || (db[tableName] = []);\n        // naive onConflict by project_id,member_id\n        const existing = rows.find(r => r.project_id === payload.project_id && r.member_id === payload.member_id);\n        if (existing) {\n          Object.assign(existing, payload);\n          return { data: [existing], error: null };\n        }\n        const row = Object.assign({}, payload);\n        if (!row.id) row.id = uuidv4();\n        rows.push(row);\n        return { data: [row], error: null };\n      },\n      single: async () => {\n        const rows = db[tableName] || [];\n        const filtered = rows.filter(r => q._where.every(w => String(r[w.k]) === String(w.v)));\n        return { data: filtered[0] || null, error: null };\n      }\n    };\n    return q;\n  }\n\n  const fakeAdmin = {\n    from: (table: string) => createFrom(table),\n  };\n\n  supabaseAdmin = fakeAdmin as any;\n} else {\n  throw new Error(\n    \"Missing NEXT_PUBLIC_SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY in environment. Set APP_ALLOW_FAKE_SUPABASE=1 to enable a local fake client for tests.\"\n  );\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///Users/pietromontanti/Desktop/approved-clean/Approved/app/api/references/route.ts"],"sourcesContent":["// app/api/references/route.ts\nimport { NextResponse } from \"next/server\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { supabaseAdmin } from \"@/lib/supabaseAdmin\";\n\nconst SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst STORAGE_BUCKET = process.env.NEXT_PUBLIC_SUPABASE_STORAGE_BUCKET || \"media\";\nconst SIGNED_URL_TTL_SECONDS = parseInt(\n  process.env.NEXT_PUBLIC_SUPABASE_SIGNED_TTL || \"7200\",\n  10\n);\n\nconst isUuid = (value: string) =>\n  typeof value === \"string\" &&\n  /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(\n    value\n  );\n\nconst isAbsoluteUrl = (url: string | null) => !!url && /^https?:\\/\\//i.test(url);\n\nfunction normalizeStoragePath(path: string | null) {\n  if (!path) return null;\n  const trimmed = path.replace(/^\\/+/, \"\");\n  if (trimmed.startsWith(`${STORAGE_BUCKET}/`)) {\n    return trimmed.slice(STORAGE_BUCKET.length + 1);\n  }\n  return trimmed;\n}\n\nfunction extractPathFromSupabaseUrl(url: string) {\n  try {\n    const u = new URL(url);\n    const parts = u.pathname.split(\"/\").filter(Boolean);\n    const idx = parts.findIndex(p => p === \"object\");\n    if (idx >= 0) {\n      const after = parts.slice(idx + 1);\n      if (after.length >= 2 && after[1] === STORAGE_BUCKET) {\n        return after.slice(2).join(\"/\");\n      }\n      if (after.length >= 3 && after[0] === \"sign\" && after[2] === STORAGE_BUCKET) {\n        return after.slice(3).join(\"/\");\n      }\n    }\n  } catch (err) {\n    console.warn(\"[GET /api/references] Failed to parse Supabase URL\", { url, err });\n  }\n  return null;\n}\n\nasync function resolveMediaUrl(raw: string | null): Promise<string | null> {\n  if (!raw) return null;\n\n  if (isAbsoluteUrl(raw)) {\n    const supaPath = SUPABASE_URL ? extractPathFromSupabaseUrl(raw) : null;\n    if (!supaPath) return raw;\n    raw = supaPath;\n  }\n\n  const cleanPath = normalizeStoragePath(raw);\n  if (!cleanPath) return null;\n\n  try {\n    const { data, error } = await supabaseAdmin.storage\n      .from(STORAGE_BUCKET)\n      .createSignedUrl(cleanPath, SIGNED_URL_TTL_SECONDS);\n\n    if (error) {\n      console.error(\"[GET /api/references] Signed URL error\", { path: cleanPath, error });\n    }\n\n    if (data?.signedUrl) {\n      return data.signedUrl;\n    }\n  } catch (err) {\n    console.error(\"[GET /api/references] Exception signing URL\", err);\n  }\n\n  if (SUPABASE_URL) {\n    return `${SUPABASE_URL}/storage/v1/object/public/${STORAGE_BUCKET}/${cleanPath}`;\n  }\n\n  return `/${cleanPath}`;\n}\n\n/**\n * GET /api/references?projectId=xxx\n * Ritorna reference files di un progetto\n */\nexport async function GET(req: Request) {\n  try {\n    const url = new URL(req.url);\n    const projectId = url.searchParams.get('projectId');\n\n    if (!projectId) {\n      return NextResponse.json({ error: 'projectId required' }, { status: 400 });\n    }\n\n    const { data: roots, error } = await supabaseAdmin\n      .from(\"references_root\")\n      .select('*')\n      .eq(\"project_id\", projectId)\n      .order(\"created_at\", { ascending: false });\n\n    if (error) {\n      console.error(\"[GET /api/references] Error:\", error);\n      return NextResponse.json({ error: error.message }, { status: 500 });\n    }\n\n    const rootIds = (roots || []).map(r => r.id);\n    let versions: any[] = [];\n\n    if (rootIds.length) {\n      const { data: versionRows, error: versionErr } = await supabaseAdmin\n        .from(\"reference_versions\")\n        .select('*')\n        .in(\"root_id\", rootIds)\n        .order(\"created_at\", { ascending: true });\n\n      if (versionErr) {\n        console.error(\"[GET /api/references] Version load error\", versionErr);\n      } else {\n        versions = versionRows || [];\n      }\n    }\n\n    const versionsByRoot: Record<string, any[]> = {};\n    for (const v of versions) {\n      const urlSigned = await resolveMediaUrl(v.url || v.thumbnail_path || null);\n      const thumbSigned = await resolveMediaUrl(v.thumbnail_url || v.thumbnail_path || null);\n      const prepared = {\n        ...v,\n        url: urlSigned || v.url,\n        thumbnail_url: thumbSigned || v.thumbnail_url,\n      };\n      if (!versionsByRoot[prepared.root_id]) versionsByRoot[prepared.root_id] = [];\n      versionsByRoot[prepared.root_id].push(prepared);\n    }\n\n    const enriched = (roots || []).map(r => ({\n      ...r,\n      versions: versionsByRoot[r.id] || [],\n    }));\n\n    return NextResponse.json({ references: enriched }, { status: 200 });\n  } catch (err: any) {\n    console.error(\"[GET /api/references] Exception:\", err);\n    return NextResponse.json({ error: err.message }, { status: 500 });\n  }\n}\n\nexport async function POST(req: Request) {\n  try {\n    const body = await req.json();\n    const { project_id, root_id, name, type, url, size } = body;\n\n    if (!project_id || !name || !url) {\n      return NextResponse.json(\n        { error: \"project_id, name, and url are required\" },\n        { status: 400 }\n      );\n    }\n\n    if (!isUuid(project_id)) {\n      return NextResponse.json(\n        { error: \"project_id must be a UUID\" },\n        { status: 400 }\n      );\n    }\n\n    // If root_id is provided, add to existing reference root\n    if (root_id) {\n      if (!isUuid(root_id)) {\n        return NextResponse.json(\n          { error: \"root_id must be a UUID\" },\n          { status: 400 }\n        );\n      }\n\n      const version_id = uuidv4();\n      const { data, error } = await supabaseAdmin\n        .from(\"reference_versions\")\n        .insert({\n          id: version_id,\n          root_id,\n          name,\n          type: type || null,\n          url,\n          size: size || null,\n        })\n        .select()\n        .single();\n\n      if (error) {\n        console.error(\"[POST /api/references] Supabase error\", error);\n        return NextResponse.json({ error: error.message }, { status: 500 });\n      }\n\n      return NextResponse.json({ version: data }, { status: 201 });\n    }\n\n    // Create new reference root and version\n    const root_id_new = uuidv4();\n    const version_id = uuidv4();\n\n    // Insert root\n    const { data: rootData, error: rootError } = await supabaseAdmin\n      .from(\"references_root\")\n      .insert({\n        id: root_id_new,\n        project_id,\n        name,\n        active_version_index: 0,\n      })\n      .select()\n      .single();\n\n    if (rootError) {\n      console.error(\"[POST /api/references] Root insert error\", rootError);\n      return NextResponse.json({ error: rootError.message }, { status: 500 });\n    }\n\n    // Insert version\n    const { data: versionData, error: versionError } = await supabaseAdmin\n      .from(\"reference_versions\")\n      .insert({\n        id: version_id,\n        root_id: root_id_new,\n        name,\n        type: type || null,\n        url,\n        size: size || null,\n      })\n      .select()\n      .single();\n\n    if (versionError) {\n      console.error(\"[POST /api/references] Version insert error\", versionError);\n      return NextResponse.json({ error: versionError.message }, { status: 500 });\n    }\n\n    return NextResponse.json(\n      { root: rootData, version: versionData },\n      { status: 201 }\n    );\n  } catch (err: any) {\n    console.error(\"[POST /api/references] Error\", err);\n    return NextResponse.json(\n      { error: err.message || \"Internal error\" },\n      { status: 500 }\n    );\n  }\n}\n\nexport async function DELETE(req: Request) {\n  try {\n    const body = await req.json();\n    const { rootId, versionId } = body;\n\n    if (!rootId) {\n      return NextResponse.json(\n        { error: \"rootId is required\" },\n        { status: 400 }\n      );\n    }\n\n    if (!isUuid(rootId)) {\n      return NextResponse.json(\n        { error: \"rootId must be a UUID\" },\n        { status: 400 }\n      );\n    }\n\n    // Delete specific version if versionId provided\n    if (versionId) {\n      if (!isUuid(versionId)) {\n        return NextResponse.json(\n          { error: \"versionId must be a UUID\" },\n          { status: 400 }\n        );\n      }\n\n      const { error } = await supabaseAdmin\n        .from(\"reference_versions\")\n        .delete()\n        .eq(\"id\", versionId)\n        .eq(\"root_id\", rootId);\n\n      if (error) {\n        console.error(\"[DELETE /api/references] Version delete error\", error);\n        return NextResponse.json({ error: error.message }, { status: 500 });\n      }\n\n      return NextResponse.json({ success: true, message: \"Version deleted\" }, { status: 200 });\n    }\n\n    // Delete entire reference root group (cascade deletes versions)\n    const { error } = await supabaseAdmin\n      .from(\"references_root\")\n      .delete()\n      .eq(\"id\", rootId);\n\n    if (error) {\n      console.error(\"[DELETE /api/references] Root delete error\", error);\n      return NextResponse.json({ error: error.message }, { status: 500 });\n    }\n\n    return NextResponse.json({ success: true, message: \"Reference group deleted\" }, { status: 200 });\n  } catch (err: any) {\n    console.error(\"[DELETE /api/references] Error\", err);\n    return NextResponse.json(\n      { error: err.message || \"Internal error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}