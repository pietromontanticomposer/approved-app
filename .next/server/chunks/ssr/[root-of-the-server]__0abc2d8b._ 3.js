module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},33688,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e(){let e=(0,d.useRouter)(),f=(0,d.useParams)().token,[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(!1);(0,c.useEffect)(()=>{u()},[f]);let u=async()=>{try{if(!f||"null"===f){console.warn("[Invite] Missing or invalid token:",f),r("Invito non valido."),n(!1);return}let{getSupabaseClient:b}=await a.A(61780),c=b();h(c);let{data:{user:d}}=await c.auth.getUser();j(d);let e=await fetch(`/api/invites/details?token=${encodeURIComponent(f)}`),g=await e.json(),i=e.ok?null:g?.error||"Invite fetch failed",k=e.ok?g:null;if(i){let a=i.message||JSON.stringify(i,Object.getOwnPropertyNames(i));console.error("Error fetching invite (RPC):",a,i),r("Invito non trovato o non valido."),n(!1);return}if(!k||Array.isArray(k)&&0===k.length){r("Invito non trovato, scaduto o giÃ  utilizzato."),n(!1);return}let m=Array.isArray(k)?k[0]:k;l(m),n(!1)}catch(a){console.error("Error initializing invite:",a),r("Errore durante il caricamento dell'invito."),n(!1)}},v=async()=>{if(!i){localStorage.setItem("pending_invite",f),e.push("/login");return}if(k.email&&k.email!==i.email)return void r(`Questo invito \xe8 riservato a ${k.email}. Hai effettuato l'accesso come ${i.email}.`);p(!0),r("");try{let{data:a,error:b}=await g.rpc("accept_invite",{invite_token:f,accepting_user_id:i.id});if(b){console.error("Error accepting invite:",b),r("Errore durante l'accettazione dell'invito."),p(!1);return}if(!a.success){r(a.error||"Errore durante l'accettazione dell'invito."),p(!1);return}t(!0);try{k&&k.project_id&&localStorage.setItem("open_project",k.project_id)}catch(a){console.warn("[Invite] Could not set open_project",a)}setTimeout(()=>{e.push("/")},1200)}catch(a){console.error("Error accepting invite:",a),r("Errore imprevisto."),p(!1)}};if(m)return(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0a0a",color:"#fff"},children:(0,b.jsxs)("div",{style:{textAlign:"center"},children:[(0,b.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"â³"}),(0,b.jsx)("div",{children:"Caricamento invito..."})]})});if(q&&!k)return(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0a0a",color:"#fff"},children:(0,b.jsxs)("div",{style:{background:"#1a1a1a",padding:"2rem",borderRadius:"8px",maxWidth:"500px",width:"100%",border:"1px solid #333",textAlign:"center"},children:[(0,b.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"âŒ"}),(0,b.jsx)("h1",{style:{marginBottom:"1rem",color:"#ff4444"},children:"Invito non valido"}),(0,b.jsx)("p",{style:{color:"#999",marginBottom:"2rem"},children:q}),(0,b.jsx)("button",{onClick:()=>e.push("/"),style:{padding:"0.75rem 1.5rem",background:"#333",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Torna alla home"})]})});if(s)return(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0a0a",color:"#fff"},children:(0,b.jsxs)("div",{style:{background:"#1a1a1a",padding:"2rem",borderRadius:"8px",maxWidth:"500px",width:"100%",border:"1px solid #333",textAlign:"center"},children:[(0,b.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"âœ…"}),(0,b.jsx)("h1",{style:{marginBottom:"1rem",color:"#44ff44"},children:"Invito accettato!"}),(0,b.jsx)("p",{style:{color:"#999",marginBottom:"1rem"},children:"Ora fai parte del team/progetto."}),(0,b.jsx)("p",{style:{color:"#666"},children:"Reindirizzamento in corso..."})]})});let w={owner:"Proprietario",editor:"Editor",commenter:"Commentatore",viewer:"Visualizzatore"}[k.role]||k.role;return(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0a0a",color:"#fff"},children:(0,b.jsxs)("div",{style:{background:"#1a1a1a",padding:"2rem",borderRadius:"8px",maxWidth:"500px",width:"100%",border:"1px solid #333"},children:[(0,b.jsxs)("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[(0,b.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"ðŸ“§"}),(0,b.jsx)("h1",{style:{marginBottom:"0.5rem"},children:"Sei stato invitato!"}),k.invited_by_email&&(0,b.jsxs)("p",{style:{color:"#999",fontSize:"0.9rem"},children:["da ",k.invited_by_email]})]}),(0,b.jsxs)("div",{style:{background:"#0a0a0a",padding:"1.5rem",borderRadius:"6px",marginBottom:"2rem",border:"1px solid #333"},children:[k.project_name&&(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"0.25rem"},children:"Progetto"}),(0,b.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:"600"},children:k.project_name})]}),(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"0.25rem"},children:"Team"}),(0,b.jsx)("div",{style:{fontSize:"1.1rem"},children:k.team_name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"0.25rem"},children:"Ruolo"}),(0,b.jsx)("div",{style:{display:"inline-block",padding:"0.25rem 0.75rem",background:"#0066ff33",color:"#0066ff",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"500"},children:w})]}),k.email&&(0,b.jsx)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #333"},children:(0,b.jsxs)("div",{style:{color:"#999",fontSize:"0.85rem"},children:["Invito riservato a: ",(0,b.jsx)("span",{style:{color:"#fff"},children:k.email})]})})]}),i?(0,b.jsxs)("div",{children:[q&&(0,b.jsx)("div",{style:{padding:"0.75rem",background:"#4d1a1a",borderRadius:"4px",color:"#ff6b6b",marginBottom:"1rem",fontSize:"0.9rem"},children:q}),(0,b.jsx)("button",{onClick:v,disabled:o,style:{width:"100%",padding:"0.75rem",background:o?"#333":"#0066ff",color:"#fff",border:"none",borderRadius:"4px",fontSize:"1rem",cursor:o?"not-allowed":"pointer",fontWeight:"500",opacity:o?.6:1},children:o?"Accettazione in corso...":"Accetta invito"}),(0,b.jsxs)("p",{style:{textAlign:"center",color:"#666",fontSize:"0.85rem",marginTop:"1rem"},children:["Accesso effettuato come ",i.email]})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{style:{color:"#999",marginBottom:"1.5rem",textAlign:"center"},children:"Effettua l'accesso per accettare l'invito"}),(0,b.jsx)("button",{onClick:v,style:{width:"100%",padding:"0.75rem",background:"#0066ff",color:"#fff",border:"none",borderRadius:"4px",fontSize:"1rem",cursor:"pointer",fontWeight:"500"},children:"Accedi per continuare"})]})]})})}a.s(["default",()=>e])},61780,a=>{a.v(a=>Promise.resolve().then(()=>a(7291)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0abc2d8b._.js.map